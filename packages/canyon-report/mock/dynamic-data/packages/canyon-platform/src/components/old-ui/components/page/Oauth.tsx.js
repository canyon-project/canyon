window["packages/canyon-platform/src/components/old-ui/components/page/Oauth.tsx"] = {"content":"import { useEffect } from \"react\";\n\nconst CanyonPageOauth = ({ URLSearchParams, onOauthFail }) => {\n  const fetcher = (url: string) =>\n    fetch(url, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({\n        code: URLSearchParams.get(\"code\"),\n        redirectUri: location.origin + \"/oauth\",\n      }),\n    })\n      .then((res) => res.json())\n      .then((res) => {\n        if (res.statusCode >= 400) {\n          message.error(res.message);\n          localStorage.clear();\n          onOauthFail();\n        } else {\n          localStorage.setItem(\"token\", res.token);\n          window.location.href = localStorage.getItem(\"callback\") || \"/\";\n        }\n      });\n  useEffect(() => {\n    fetcher(\"/api/oauth/token\");\n  }, []);\n\n  return <Spin spinning={true}>logging in...</Spin>;\n};\n\nexport default CanyonPageOauth;\n","coverage":{"name":"zt"}}